<!DOCTYPE html>
<html lang="he">
<head>
    <meta charset="UTF-8">
    <style>
        body { 
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            align-items: center; 
            justify-content: center; 
            height: 100vh; 
            background: transparent; 
            color: white; 
            font-family: sans-serif; 
            overflow: hidden; 
        }
        
        .circle-percentage { 
            position: relative; 
            width: 120px; 
            height: 120px; 
        }
        
        .circle-percentage svg circle { 
            fill: none; 
            stroke-width: 8; 
        }
        
        /* העיגול הרקע העמום */
        .circle-percentage svg circle:first-child { 
            stroke: rgba(255, 255, 255, 0.1); 
        }
        
        /* העיגול שמתמלא */
        .circle-percentage svg circle.progress-circle {
            stroke: #00d4ff; 
            stroke-linecap: round;
            stroke-dasharray: 339.292; 
            stroke-dashoffset: 339.292;
            transform: rotate(-90deg); 
            transform-origin: 50% 50%;
            transition: stroke-dashoffset 0.1s linear;
        }
        
        /* טקסט האחוזים - מוסתר כברירת מחדל */
        .percentage-text { 
            position: absolute; 
            top: 50%; 
            left: 50%; 
            transform: translate(-50%, -50%); 
            font-size: 24px; 
            font-weight: 700; 
            color: #00d4ff; 
            display: none; 
        }

        /* יוצג רק כשיש את הקלאס המתאים */
        body.show-percent-active .percentage-text {
            display: block;
        }
    </style>
</head>
<body>

    <div class="circle-percentage">
        <svg width="120" height="120">
            <circle cx="60" cy="60" r="54"></circle>
            <circle cx="60" cy="60" r="54" class="progress-circle"></circle>
        </svg>
        <div class="percentage-text" id="percent-label">0%</div>
    </div>

    <script>
        const text = document.getElementById('percent-label');
        const circle = document.querySelector('.progress-circle');
        const circumference = 2 * Math.PI * 54;
        let val = 0;

        // --- מנגנון האזנה להודעות מהדף הראשי ---
        window.addEventListener('message', (event) => {
            // אם קיבלנו הוראה להציג/להסתיר
            if (event.data.type === 'TOGGLE_PERCENT') {
                if (event.data.visible) {
                    document.body.classList.add('show-percent-active');
                } else {
                    document.body.classList.remove('show-percent-active');
                }
            }
        });

        // --- לוגיקת האנימציה ---
        setInterval(() => {
            val++;
            if (val > 100) val = 0;
            
            const offset = circumference - (val / 100) * circumference;
            circle.style.strokeDashoffset = offset;
            text.textContent = val + '%';
        }, 50);
    </script>
</body>
</html>
